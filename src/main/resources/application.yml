# ==============================================================================
# Yuubin Proxy — Default Configuration
# ==============================================================================
# This configuration starts a single HTTP forward proxy on port 8080.
# For advanced examples (TLS, SOCKS5, routing rules, load balancing, proxy
# chaining, Kubernetes auth), see: docs/examples/

# ------------------------------------------------------------------------------
# Authentication
# ------------------------------------------------------------------------------
# Disabled by default. Enable and configure a credential source to require
# Proxy-Authorization on proxies that have authEnabled: true.
auth:
  enabled: false
  # usersPath: users.yml                 # YAML file (classpath or filesystem)
  # usersDirectory: /etc/yuubin/users    # Directory mount (K8s ConfigMap/Secret)
  # usersEnv: YUUBIN_USERS              # Env var ("user1:pass1,user2:pass2")

# ------------------------------------------------------------------------------
# Access Logging
# ------------------------------------------------------------------------------
# Access logs go to EITHER console OR file (never both).
# When fileEnabled is false (default), access logs print to stdout.
# When fileEnabled is true, access logs go ONLY to the configured file.
# Application logs (startup, shutdown, errors) always print to console.
logging:
  format: '%h %l %u %t "%r" %>s %b'
  logResponse: false                     # Set to true for verbose response auditing
  # --- File logging (disabled = console mode) ---
  # fileEnabled: true                    # Switch access logs from console to file
  # filePath: logs
  # fileName: yuubin-proxy.log
  # rotation: DAILY                      # DAILY | WEEKLY | MONTHLY | SIZE
  # maxSize: 10MB                        # Only used when rotation: SIZE
  # maxHistory: 30                       # Rotated files to keep

# ------------------------------------------------------------------------------
# Proxy Servers
# ------------------------------------------------------------------------------
proxies:
  # HTTP forward proxy — works as a standard HTTP/HTTPS proxy out of the box.
  # Configure your browser or system to use localhost:8080 as the HTTP proxy.
  - name: http-proxy
    port: 8080
    type: HTTP
    # authEnabled: false                 # Require Proxy-Authorization (needs auth.enabled: true)
    # timeout: 60000                     # Connection timeout in ms (default: 60000)
    # maxConnections: 10000              # Max concurrent connections (default: 10000)
    # keepAlive: true                    # TCP keep-alive (default: true)
    # bindAddress: 0.0.0.0              # Bind to specific interface (default: all)
    # --- Routing rules (optional) ---
    # rules:
    #   - path: /api
    #     target: http://backend:8080
    #     headers:
    #       X-Proxy-By: Yuubin

  # --- SOCKS5 proxy (uncomment to enable) ---
  # - name: socks5-proxy
  #   port: 1080
  #   type: SOCKS5
  #   authEnabled: false
  #   timeout: 30000

# ------------------------------------------------------------------------------
# Admin / Metrics Server
# ------------------------------------------------------------------------------
# Exposes /health (liveness probe) and /metrics (Prometheus format).
admin:
  enabled: true
  port: 9090
  bindAddress: "127.0.0.1"               # Loopback only; use 0.0.0.0 for K8s

# ------------------------------------------------------------------------------
# Advanced Options (uncomment as needed)
# ------------------------------------------------------------------------------
# certificatesPath: /etc/yuubin/certs    # Base directory for TLS keystores
# globalBlacklist:                       # IPs blocked across ALL proxies
#   - 192.168.1.100
